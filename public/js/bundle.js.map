{"mappings":"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","sources":["public/js/index.js","public/js/forgot.js","public/js/alerts.js","public/js/login.js","public/js/mapbox.js","public/js/register.js","public/js/updateSettings.js","public/js/reset.js","public/js/stripe.js"],"sourcesContent":["import { forgotPassword } from './forgot.js';\nimport { login, logout } from './login.js';\nimport { displayMap } from './mapbox.js';\nimport { register } from './register.js';\nimport { updateSettings } from './updateSettings.js';\nimport { resetPassword } from './reset.js';\nimport { bookTour } from './stripe.js';\n\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.login-form');\nconst registerForm = document.querySelector('.register-form');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst formUserData = document.querySelector('.form-user-data');\nconst formUserPassword = document.querySelector('.form-user-password');\nconst fileInput = document.querySelector('.form__upload');\nconst passwordForgotForm = document.querySelector('.forgot-form');\nconst passwordResetForm = document.querySelector('.reset-form');\nconst bookBtn = document.getElementById('book-tour');\n\nif (mapBox) {\n\tconst locations = JSON.parse(mapBox.dataset.locations);\n\tdisplayMap(locations);\n}\n\nif (loginForm) {\n\tloginForm.addEventListener('submit', (e) => {\n\t\te.preventDefault();\n\t\tconst email = document.getElementById('email').value;\n\t\tconst password = document.getElementById('password').value;\n\t\tlogin(email, password);\n\t});\n}\n\nif (registerForm) {\n\tregisterForm.addEventListener('submit', (e) => {\n\t\te.preventDefault();\n\t\tconst name = document.getElementById('name').value;\n\t\tconst email = document.getElementById('email').value;\n\t\tconst password = document.getElementById('password').value;\n\t\tconst passwordConfirm = document.getElementById('password-confirm').value;\n\t\tregister(name, email, password, passwordConfirm);\n\t});\n}\n\nif (logOutBtn) {\n\tlogOutBtn.addEventListener('click', (e) => {\n\t\te.preventDefault();\n\t\tlogout();\n\t});\n}\n\nif (formUserData) {\n\tformUserData.addEventListener('submit', (e) => {\n\t\te.preventDefault();\n\n\t\tconst form = new FormData();\n\t\tform.append('name', document.getElementById('name').value);\n\t\tform.append('email', document.getElementById('email').value);\n\n\t\tupdateSettings(form, 'data');\n\t});\n}\n\nif (fileInput) {\n\tfileInput.addEventListener('change', async (e) => {\n\t\tconst form = new FormData();\n\n\t\tform.append('photo', document.getElementById('photo').files[0]);\n\n\t\tconst newImage = await updateSettings(form, 'photo');\n\n\t\tif (newImage) {\n\t\t\tdocument.querySelector('.nav__user-img').setAttribute('src', `/img/users/${newImage}`);\n\t\t\tdocument\n\t\t\t\t.querySelector('.form__user-photo')\n\t\t\t\t.setAttribute('src', `/img/users/${newImage}`);\n\t\t}\n\t});\n}\n\nif (formUserPassword) {\n\tformUserPassword.addEventListener('submit', async (e) => {\n\t\te.preventDefault();\n\t\tdocument.querySelector('.btn--save-password').innerHTML = 'Updating...';\n\n\t\tconst email = document.getElementById('email').value;\n\t\tconst passwordCurrent = document.getElementById('password-current').value;\n\t\tconst password = document.getElementById('password').value;\n\t\tconst passwordConfirm = document.getElementById('password-confirm').value;\n\n\t\tawait updateSettings({ email, passwordCurrent, password, passwordConfirm }, 'password');\n\t\tdocument.querySelector('.btn--save-password').innerHTML = 'Save password';\n\t\tdocument.getElementById('password-current').value = '';\n\t\tdocument.getElementById('password').value = '';\n\t\tdocument.getElementById('password-confirm').value = '';\n\t});\n}\n\nif (passwordForgotForm) {\n\tpasswordForgotForm.addEventListener('submit', (e) => {\n\t\te.preventDefault();\n\t\tconst email = document.getElementById('email').value;\n\n\t\tforgotPassword(email);\n\t});\n}\n\nif (passwordResetForm) {\n\tpasswordResetForm.addEventListener('submit', (e) => {\n\t\te.preventDefault();\n\t\tconst password = document.getElementById('password').value;\n\t\tconst passwordConfirm = document.getElementById('password-confirm').value;\n\n\t\tresetPassword(password, passwordConfirm);\n\t});\n}\n\nif (bookBtn) {\n\tbookBtn.addEventListener('click', (e) => {\n\t\te.target.textContent = 'Processing...';\n\t\tconst { tourId } = e.target.dataset;\n\t\tbookTour(tourId);\n\t});\n}\n","import { showAlert } from './alerts.js';\n\nexport const forgotPassword = async (email) => {\n\ttry {\n\t\tconst res = await axios({\n\t\t\tmethod: 'POST',\n\t\t\turl: '/api/v1/users/forgotPassword',\n\t\t\tdata: {\n\t\t\t\temail,\n\t\t\t},\n\t\t});\n\n\t\tif (res.data.status === 'success') {\n\t\t\tshowAlert('success', 'Reset password has been sent to your email!');\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tlocation.assign('/');\n\t\t\t}, 1500);\n\t\t}\n\t} catch (err) {\n\t\tshowAlert('error', err.response.message);\n\t}\n};\n","export const hideAlert = () => {\n\tconst el = document.querySelector('.alert');\n\tif (el) el.parentElement.removeChild(el);\n  };\n  \n  // type is 'success' or 'error'\n  export const showAlert = (type, msg) => {\n\thideAlert();\n\tconst markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n\tdocument.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n\twindow.setTimeout(hideAlert, 5000);\n  };","import { showAlert } from './alerts.js';\n\nexport const login = async (email, password) => {\n\ttry {\n\t\tconst res = await axios({\n\t\t\tmethod: 'POST',\n\t\t\turl: '/api/v1/users/login',\n\t\t\tcredentials: 'include',\n\t\t\tdata: {\n\t\t\t\temail,\n\t\t\t\tpassword,\n\t\t\t},\n\t\t});\n\n\t\tif (res.data.status === 'success') {\n\t\t\tshowAlert('success', 'Logged in successfully!');\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tlocation.assign('/');\n\t\t\t}, 1500);\n\t\t}\n\t} catch (err) {\n\t\tshowAlert('error', err.response.data.message);\n\t}\n};\n\nexport const logout = async () => {\n\ttry {\n\t\tconst res = await axios({\n\t\t\tmethod: 'GET',\n\t\t\tcredentials: 'include',\n\t\t\turl: '/api/v1/users/logout',\n\t\t});\n\n\t\tif (res.data.status === 'success') {\n\t\t\tshowAlert('success', 'Logged out successfully!');\n\t\t\tlocation.reload(true);\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tlocation.assign('/');\n\t\t\t}, 1500);\n\t\t}\n\t} catch (err) {\n\t\tshowAlert('error', err);\n\t}\n};\n","export const displayMap = (locations) => {\n\tmapboxgl.accessToken =\n\t\t'pk.eyJ1IjoiYWxiaW5hdG9yMTcwNyIsImEiOiJjbGpwY3Z5NjcwMDNnM25tdmVhb3UwNng4In0.XsaRBpx7PndslhJ8mOVq9Q';\n\tvar map = new mapboxgl.Map({\n\t\tcontainer: 'map',\n\t\tstyle: 'mapbox://styles/albinator1707/cljpd19fx00t501qy2jmebgjq',\n\t\tscrollZoom: false,\n\t});\n\n\tconst bounds = new mapboxgl.LngLatBounds();\n\n\tlocations.forEach((loc) => {\n\t\tconst el = document.createElement('div');\n\t\tel.className = 'marker';\n\n\t\tnew mapboxgl.Marker({\n\t\t\telement: el,\n\t\t\tanchor: 'bottom',\n\t\t})\n\t\t\t.setLngLat(loc.coordinates)\n\t\t\t.addTo(map);\n\n\t\tnew mapboxgl.Popup({\n\t\t\toffset: 30,\n\t\t})\n\t\t\t.setLngLat(loc.coordinates)\n\t\t\t.setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n\t\t\t.addTo(map);\n\n\t\tbounds.extend(loc.coordinates);\n\t});\n\n\tmap.fitBounds(bounds, {\n\t\tpadding: {\n\t\t\ttop: 200,\n\t\t\tbottom: 150,\n\t\t\tleft: 100,\n\t\t\tright: 100,\n\t\t},\n\t});\n};\n","import { showAlert } from './alerts.js';\n\nexport const register = async (name, email, password, passwordConfirm) => {\n\ttry {\n\t\tconst res = await axios({\n\t\t\tmethod: 'POST',\n\t\t\turl: '/api/v1/users/signup',\n\t\t\tdata: {\n\t\t\t\tname,\n\t\t\t\temail,\n\t\t\t\tpassword,\n\t\t\t\tpasswordConfirm,\n\t\t\t},\n\t\t});\n\n\t\tif (res.data.status === 'success') {\n\t\t\tshowAlert('success', 'Registered successfully!');\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tlocation.assign('/me');\n\t\t\t}, 1500);\n\t\t}\n\t} catch (err) {\n\t\tshowAlert('error', err.response.data.message);\n\t}\n};\n","import { showAlert } from './alerts.js';\n\nexport const updateSettings = async (data, type) => {\n\ttry {\n\t\tconst url =\n\t\t\ttype === 'password' ? '/api/v1/users/updateMyPassword' : '/api/v1/users/updateMe';\n\t\tconst res = await axios({\n\t\t\tmethod: 'PATCH',\n\t\t\turl,\n\t\t\tdata,\n\t\t});\n\n\t\tif (res.data.status === 'success') {\n\t\t\tshowAlert('success', `${type.toUpperCase()} are successfully updated`);\n\t\t\tif (type === 'photo') {\n\t\t\t\treturn res.data.data.user.photo;\n\t\t\t}\n\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tlocation.assign('/');\n\t\t\t}, 1500);\n\t\t}\n\t} catch (err) {\n\t\tshowAlert('error', err.response.data.message);\n\t}\n};\n","import { showAlert } from './alerts.js';\n\nexport const resetPassword = async (password, passwordConfirm) => {\n\ttry {\n\t\tconst res = await axios({\n\t\t\tmethod: 'PATCH',\n\t\t\turl: `/api/v1/users/resetPassword/${window.location.pathname.split('/')[2]}`,\n\t\t\tdata: {\n\t\t\t\tpassword,\n\t\t\t\tpasswordConfirm,\n\t\t\t},\n\t\t});\n\n\t\tif (res.data.status === 'success') {\n\t\t\tshowAlert('success', 'Password has been successfully reset!');\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tlocation.assign('/');\n\t\t\t}, 1500);\n\t\t}\n\t} catch (err) {\n\t\tshowAlert('error', err.response.data.message);\n\t}\n};\n","import { showAlert } from './alerts.js';\n\nexport const bookTour = async (tourId) => {\n\tconst stripe = Stripe(process.env.STRIPE_PUBLIC_KEY);\n\ttry {\n\t\tconst session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n\n\t\tawait stripe.redirectToCheckout({\n\t\t\tsessionId: session.data.session.id,\n\t\t});\n\t} catch (err) {\n\t\tconsole.log(err);\n\t\tshowAlert('error', err);\n\t}\n};\n"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../"}